{% extends "global/Page.html" %}
{% load otree static %}

{% block title %}
    <div style="margin-left:-25%">
        Seller
    </div>
{% endblock %}

{% block content %}
    <div class="container" style="margin-left:-25%">
        <div class="row">
            <div class="col-md-8">
                <h5>Auction type: Price Cap</h5>

                <hr/>

                <p>
                    Your cost: {{ player.cost }}
                    <br/>
                    Price cap: {{ player.priceCap }}
                </p>

                <p>Price Cap Formula: {{ general_cap_formula }}
                    <br/>
                    Price Cap: {{ player_cap_formula }}
                </p>
                <p>Score Formula: {{ score_formula }} </p>

                <hr/>

                {% if player.priceCap < player.cost %}
                    <p style="border:4px; border-style:solid; border-color:#FF0000; padding: 1em;">
                        WARNING: Since your price cap is less than your cost,
                        the only number of ECUs you can offer is your price cap.
                        If you do decide to participate and the buyer
                        purchases your object, you will lose ECUs.
                    </p>
                {% endif %}


                <p>Do you want to participate?</p>

                {% formfield player.participate with label="" %}

                {% formfield player.offer label="Enter your Offer:" %}

                {{ form.participate.errors }}

                <hr/>

                <p>You have the option to buy additional benefits points. Please select one
                of the choices below:</p>

                {% formfield player.benefits_choice with label="" %}

                <p>
                    <form onsubmit="calculate_score({{ player.offer }}, {{ player.priceCap }}, {{ player.benefits_purchased }})">
                        <fieldset>
                        <legend>Preview score:</legend>
                        Test an offer:<br>
                        <input type="number" name="test_offer" value="" id="offer_id"><br>
                        Buy benefits?<br>
                        <input type="radio" name="test_benefits" value=15 id="ben_id_15">15<br>
                        <input type="radio" name="test_benefits" value=30 id="ben_id_30">30<br>
                        <input type="radio" name="test_benefits" value=0 id="ben_id_0" checked>None<br>
                        <label type="number" id="preview_id" value=""></label><br>
                        <button type= "button" id="score_btn" name="calc_score" class="btn btn-primary btn-large" onclick="calculate_score()">
                        Preview Score
                        </button>
                        </fieldset>
                    </form>

                <script>
                    function calculate_score(x,y,z) {
                        var x = document.getElementById("offer_id").value
                        var y = {{ player.priceCap }}

                        if (document.getElementById("ben_id_15").checked) {
                            var z = document.getElementById("ben_id_15").value
                        }
                        else if (document.getElementById("ben_id_30").checked) {
                            var z = document.getElementById("ben_id_30").value
                        }
                        else if (document.getElementById("ben_id_0").checked) {
                            var z = document.getElementById("ben_id_0").value
                        }

                        var base_ben = parseInt(150)

                        var score = base_ben + parseInt(z) - parseInt(x)
                        document.getElementById("preview_id").textContent = score
                    }
                </script>

            </div>
            <div class="col-md-4">
                {% include 'LeepsCRP/Table1_1.html' %}
            </div>
        </div>
    </div>

    <div style="margin-left:-25%">
        <button class="otree-btn-next btn btn-primary next-button otree-next-button">Next</button>
    </div>
{% endblock %}
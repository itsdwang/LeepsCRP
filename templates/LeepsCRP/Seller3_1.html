{% extends "global/Page.html" %}
{% load otree static %}

{% block title %}
    <div style="margin-left:-25%">
        Seller
    </div>
{% endblock %}

{% block content %}
    <div class="container" style="margin-left:-25%">
        <div class="row">
            <div class="col-md-8">
                <h5>Auction type: Reference Price</h5>

                <hr/>

                <p>
                    Your cost: {{ player.cost }}
                    <br/>
                    Reference price: {{ player.refPrice }}
                </p>

                <p>Score Formula: {{ score_formula }} </p>

                <hr/>

                <p>Do you want to participate?</p>

                {% formfield player.participate with label="" %}

                {% formfield player.offer label="Enter your Offer:" %}

                {{ form.participate.errors }}


                {% block scripts %}

                </p>

                {% endblock %}

                <hr/>

                <p>You have the option to buy additional benefits points. Please select one
                of the choices below:</p>

                {% formfield player.benefits_choice with label="" %}

                <p>
                    <form onsubmit="calculate_score({{ player.offer }}, {{ player.refPrice }}, {{ player.benefits_purchased }})">
                        <fieldset>
                        <legend>Preview score:</legend>
                        Test an offer:<br>
                        <input type="number" name="test_offer" value="" id="score_id"><br>
                        Buy benefits?<br>
                        <input type="radio" name="test_benefits" value=15 id="ben_id_15">15<br>
                        <input type="radio" name="test_benefits" value=30 id="ben_id_30">30<br>
                        <input type="radio" name="test_benefits" value=0 id="ben_id_0" checked>None<br>
                        <label type="number" id="preview_id" value=""></label><br>
                        <button type= "button" id="score_btn" name="calc_score" class="btn btn-primary btn-large" onclick="calculate_score()">
                        Preview Score
                        </button>
                        </fieldset>
                    </form>

                <script>
                    function calculate_score(x,y,z) {
                        var x = document.getElementById("score_id").value
                        var y = {{ player.refPrice }}

                        if (document.getElementById("ben_id_15").checked) {
                            var z = document.getElementById("ben_id_15").value
                        }
                        else if (document.getElementById("ben_id_30").checked) {
                            var z = document.getElementById("ben_id_30").value
                        }
                        else if (document.getElementById("ben_id_0").checked) {
                            var z = document.getElementById("ben_id_0").value
                        }

                        var base_ben = parseInt(150)
                        var scale = parseInt(50)
                        var frac = parseInt(x)/parseInt(y)

                        var score = base_ben + parseInt(z) - parseInt(y) - scale*frac
                        document.getElementById("preview_id").textContent = score
                    }
                </script>
            </p>

            </div>
            <div class="col-md-4">
                {% include 'LeepsCRP/Table1_1.html' %}
            </div>
        </div>
    </div>

    <div style="margin-left:-25%">
        <button class="otree-btn-next btn btn-primary next-button otree-next-button">Next</button>
    </div>

{% endblock %}
